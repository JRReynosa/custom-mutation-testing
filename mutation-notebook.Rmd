---
title: "Mutation Testing"
output: html_document
---
```{r include=FALSE}
# Load libraries

require(dplyr)
require(lmerTest)
```

```{r include=FALSE}
# Load data

mutationdata = read.csv('data/f16.csv')
mutationdata = mutationdata %>% rename(mutationCoverage = coverage, 
                                       branchCoverage = elementsCovered, 
                                       projectScore = score.reftest) %>%
  rowwise() %>%
  mutate(solved = ifelse(projectScore >= 0.95, TRUE, FALSE))
mutationdata$userId = factor(mutationdata$userId)
solved = mutationdata %>% filter(solved)
unsolved = mutationdata %>% filter(!solved)
```

```{r echo=FALSE}
boxplot(mutationdata$mutationCoverage, mutationdata$branchCoverage, ylab="Code coverage", 
        names = c("Mutation coverage", "Branch coverage"), main="Code coverage distributions")
```

## Relationship with project outcomes

### Project score

`Solved` projects are projects that scored above a 95\%.

#### Mutation coverage

$H_O =$ Mutation coverage for solved projects is less than or equal to that of unsolved ones.

$H_A =$ Mutation coverage is higher for solved projects than unsolved ones.

```{r echo=FALSE}
# Non-normal, so use nonparametric tests

 wilcox.test(solved$mutationCoverage, unsolved$mutationCoverage, alternative = 'g')
```

**Linear mixed effects model**

Students are subjects; assignments are repeated measures.

```{r echo=FALSE}
mutation.fit.correctness = lmer(projectScore ~ mutationCoverage + (1 | userId), data = mutationdata)
anova(mutation.fit.correctness)
```

Model BIC = `r BIC(mutation.fit.correctness)`

#### Branch coverage

$H_O =$ Branch coverage for solved projects is less than or equal to that of unsolved ones.

$H_A =$ Branch coverage is higher for solved projects than unsolved ones.

```{r echo=FALSE}
wilcox.test(solved$branchCoverage, unsolved$branchCoverage, alternative = 'g')
```

**Linear mixed effects model**

```{r echo=FALSE}
branch.fit.correctness = lmer(projectScore ~ branchCoverage + (1 | userId), data = mutationdata)
anova(branch.fit.correctness)
```

Model BIC = `r BIC(branch.fit.correctness)`

*Seems to be a much better model, but almost suspiciously so.* Difference in models is also present in simple linear models.

